@page
@model Fitness_Tracker2._0WEBApp.Pages.DetailsModel
@{
    ViewData["Title"] = "Workout Details";
}

@section Styles {
    <link rel="stylesheet" href="~/css/detailsForWorkoutPageStyle.css" asp-append-version="true" />
}

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="details-alert details-alert-danger">
        @Model.ErrorMessage
    </div>
}

@if (!string.IsNullOrEmpty(Model.SuccessMessage))
{
    <div class="details-alert details-alert-success">
        @Model.SuccessMessage
    </div>
}

<div class="details-container">
    <h2 class="details-title">@Model.Workout.GetName()</h2>
    <p class="details-description">@Model.Workout.GetDescription()</p>
    <p class="details-level">Level: @Model.Workout.GetWorkoutLevel()</p>

    <h3 class="details-exercises-title">Exercises</h3>
    <ul class="details-exercises-list">
        @foreach (var exercise in Model.Workout.GetExercises())
        {
            <li>
                <strong>@exercise.GetName()</strong>: @exercise.GetDescription()

                @if (exercise is ExerciseLibrary.Strength strengthExercise)
                {
                    <ul>
                        <li>Reps: @strengthExercise.GetReps()</li>
                        <li>Sets: @strengthExercise.GetSets()</li>
                        <li>Weight: @strengthExercise.GetWeight() kg</li>
                        <li>Muscle Group: @strengthExercise.GetMuscleGroup()</li>
                    </ul>
                }
                @if (exercise is ExerciseLibrary.Cardio cardioExercise)
                {
                <ul>
                    <li>Duration: @cardioExercise.GetDuration()</li>
                </ul>
                }
            </li>
        }
    </ul>

    <h3 class="details-actions-title">Actions</h3>
    <form method="post" asp-page-handler="AddToFavorites" class="details-form">
        <input type="hidden" asp-for="Id" value="@Model.Workout.GetId()" />
        <button type="submit" class="details-button">Add to Favorites</button>
    </form>

    <h3 class="details-calculate-title">Calculate Calories Burned</h3>
    <form method="post" asp-page-handler="CalculateCalories" class="details-form">
        <input type="hidden" asp-for="Id" value="@Model.Workout.GetId()" />
        <button type="submit" class="details-button">Calculate</button>
    </form>

    @if (Model.TotalCaloriesBurned > 0)
    {
        <p class="details-calories-result">Total Calories Burned: @Model.TotalCaloriesBurned</p>
    }

    <h3>Average Rating: @Model.CalculatedRating.ToString("0.00") (out of @Model.RatingCount Users)</h3>

    <h3 class="details-rating-title">Add Your Rating</h3>
    <div class="details-rating-section">
        <form method="post" asp-page-handler="AddRating" class="details-rating-form">
            <input type="hidden" asp-for="Id" value="@Model.Workout.GetId()" />
            <label for="rating" class="details-rating-label">Rating (1-5):</label>
            <input type="number" asp-for="RatingValue" min="1" max="5" class="details-rating-input" />
            <button type="submit" class="details-button">Submit Rating</button>
        </form>
    </div>
    

    <a asp-page="/Application" class="details-back-link">Back to list</a>
</div>

@section Scripts{
    <script src="~/js/JavaScript.js"></script>
}
